@page "{handler?}"


@model CurrencyApp.Pages.ItemsModel
@{
    ViewData["Title"] = "Lista przedmiotów";
}
@Html.AntiForgeryToken()
<form method="post">

    <div class="row align-items-start"> 
        @* Left Form *@
        <div class="row col-md-12 col-lg-3 pb-3">
            <div class="col-md-6 col-lg-12 pb-1 border-dark border">
                @await Html.PartialAsync("~/Pages/Tables/ItemsPartials/_CheckBoxesItPartial.cshtml", Model)
            </div>
            <div class="col-md-6 col-lg-12 pb-1 border-dark border">
                @await Html.PartialAsync("~/Pages/Tables/ItemsPartials/_ExcelPartial.cshtml", Model)
            </div>
            <div class="col-12 pb-1 border-dark border">
                @await Html.PartialAsync("~/Pages/Tables/ItemsPartials/_ButtonsPartial.cshtml", Model)
            </div>
            <div>

            </div>
        </div>

        @* Center table *@
        <div class="col-md-12 col-lg-9">
            @* For adding an item*@
            @await Html.PartialAsync("~/Pages/Tables/ItemsPartials/_AddItemPartial.cshtml", Model.AddItemModel)
            @if (!string.IsNullOrWhiteSpace(Model.ErrorString))
            {
                <div class="h3 alert-danger text-center">@Html.Raw(Model.ErrorString)</div>
            }
            @if (!string.IsNullOrWhiteSpace(Model.Messages))
            {
                <div class="h3 alert-info text-center">@Html.Raw(Model.Messages)</div>
            }
            <br />
            @* For adding an Table *@
            @await Html.PartialAsync("~/Pages/Tables/ItemsPartials/_ItemTablePartial.cshtml", Model)

        </div>
    </div>

</form>

@section scripts{
    <script src="~/lib/jqueryui/jquery-ui.js"></script>
    <script src="~/js/itemTableScript.js"></script>
    <script>
        $(function () {
            $("#sortable").sortable({
                items: "tr",
                placeholder: "table-active"
                //update: function (event, ui) {
                //    var ids = $("#sortable").sortable("serialize");
                //    ids = ids.replace("item[]=", "").split("&item[]=").map(x => parseInt(x));
                //    var url = "/Items/ChangePos";
                //    $.ajax({
                //        url: url,
                //        type: "POST",
                //        data: { ids: ids },
                //        beforeSend: function (xhr) {
                //            xhr.setRequestHeader("XSRF-TOKEN", $('input:hidden[name="__RequestVerificationToken"]').val());
                //        }
                //    }).done(function (result) {

                //    });
            });
            $("body").on("click", "button.delete", function () {
                if (!confirm("Potwierdź usnięcie przedmiotu!"))
                    return false;
            });

        });
    </script>

}
@section styles{
    <link href="~/lib/jqueryui/jquery-ui.css" rel="stylesheet" />
}
